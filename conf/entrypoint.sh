#!/bin/sh -e

COLOR_SUCCESS='\033[0;32m'
NC='\033[0m'

#===================================#
#       CALL PARENT ENTRYPOINT
#===================================#
printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
printf "\n${COLOR_SUCCESS}     INSTALLATION PRESTASHOP $DB_NAME   ${NC}\n"
printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
/tmp/docker_run.sh

#===================================#
#       CUSTOMS CONFIGURATIONS
#===================================#
if [ ! -f /var/www/html/console/console.php ];then
    

    
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    printf "\n${COLOR_SUCCESS}            INSTALLATION SDK PHP         ${NC}\n"
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    cd /var/www/html/modules/hipay_enterprise/ \
    && composer install --no-dev

    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    printf "\n${COLOR_SUCCESS}             INSTALLATION SDK JS         ${NC}\n"
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    cd lib/ \
    && bower install hipay-fullservice-sdk-js

   
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    printf "\n${COLOR_SUCCESS}     INSTALLATION PRESTASHOP CONSOLE     ${NC}\n"
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    cd /var/www/html/ \
    && git clone https://github.com/nenes25/prestashop_console.git console \
    && cd console \
    && composer install

    # Installation  HiPay's module
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    printf "\n${COLOR_SUCCESS}     INSTALLATION HiPay's Module         ${NC}\n"
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    cd /var/www/html/console/ \
    && php console.php module:install hipay_enterprise

    # Configure module credentials
        # Installation  HiPay's module
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    printf "\n${COLOR_SUCCESS}     Configuration HiPay's Module         ${NC}\n"
    printf "\n${COLOR_SUCCESS} ======================================= ${NC}\n"
    php console.php configuration:set HIPAY_CONFIG "{\"account\":{\"global\":{\"sandbox_mode\":1,\"host_proxy\":\"\",\"port_proxy\":\"\",\"user_proxy\":\"\",\"password_proxy\":\"\"},\"sandbox\":{\"api_username_sandbox\":\"$HIPAY_API_USER_TEST\",\"api_password_sandbox\":\"$HIPAY_API_PASSWORD_TEST\",\"api_tokenjs_username_sandbox\":\"$HIPAY_TOKENJS_USERNAME_TEST\",\"api_tokenjs_password_publickey_sandbox\":\"$HIPAY_TOKENJS_PUBLICKEY_TEST\",\"api_secret_passphrase_sandbox\":\"$HIPAY_SECRET_PASSPHRASE_TEST\",\"api_moto_username_sandbox\":\"\",\"api_moto_password_sandbox\":\"\",\"api_moto_secret_passphrase_sandbox\":\"\"},\"production\":{\"api_username_production\":\"\",\"api_password_production\":\"\",\"api_tokenjs_username_production\":\"\",\"api_tokenjs_password_publickey_production\":\"\",\"api_secret_passphrase_production\":\"\",\"api_moto_username_production\":\"\",\"api_moto_password_production\":\"\",\"api_moto_secret_passphrase_production\":\"\"}},\"payment\":{\"global\":{\"operating_mode\":\"api\",\"iframe_hosted_page_template\":\"basic-js\",\"display_card_selector\":0,\"display_hosted_page\":\"redirect\",\"css_url\":\"\",\"activate_3d_secure\":0,\"3d_secure_rules\":[{\"field\":\"total_price\",\"operator\":\">\",\"value\":100}],\"capture_mode\":\"automatic\",\"card_token\":0,\"activate_basket\":1,\"log_infos\":1,\"regenerate_cart_on_decline\":1,\"ccDisplayName\":\"Credit card\",\"ccFrontPosition\":1},\"credit_card\":{\"visa\":{\"displayName\":\"Visa\",\"activated\":1,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"GB\",\"FR\"],\"recurring\":1},\"mastercard\":{\"displayName\":\"Mastercard\",\"activated\":1,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"GB\",\"FR\"],\"recurring\":1},\"cb\":{\"displayName\":\"Carte Bancaire\",\"activated\":1,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"FR\"],\"recurring\":1},\"maestro\":{\"displayName\":\"Maestro\",\"activated\":1,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"GB\",\"FR\"],\"recurring\":0},\"american-express\":{\"displayName\":\"American Express\",\"activated\":1,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"GB\",\"FR\"],\"recurring\":1},\"bcmc\":{\"displayName\":\"Bancontact\",\"activated\":1,\"canRefund\":0,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"countries\":[\"BE\"],\"recurring\":0}},\"local_payment\":{\"3xcb-no-fees\":{\"group\":{\"code\":\"oney\",\"label\":\"Oney Facily Pay\"},\"displayNameBO\":\"3x Carte Bancaire sans frais - Facily Pay\",\"displayName\":\"3x Carte Bancaire sans frais - Facily Pay\",\"frontPosition\":2,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"oney.png\",\"additionalFields\":[]},\"3xcb\":{\"group\":{\"code\":\"oney\",\"label\":\"Oney Facily Pay\"},\"displayNameBO\":\"3x Carte Bancaire - Facily Pay\",\"displayName\":\"3x Carte Bancaire - Facily Pay\",\"frontPosition\":3,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"oney.png\",\"additionalFields\":[]},\"4xcb-no-fees\":{\"group\":{\"code\":\"oney\",\"label\":\"Oney Facily Pay\"},\"displayNameBO\":\"4x Carte Bancaire sans frais - Facily Pay\",\"displayName\":\"4x Carte Bancaire sans frais - Facily Pay\",\"frontPosition\":4,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"oney.png\",\"additionalFields\":[]},\"4xcb\":{\"group\":{\"code\":\"oney\",\"label\":\"Oney Facily Pay\"},\"displayNameBO\":\"4x Carte Bancaire - Facily Pay\",\"displayName\":\"4x Carte Bancaire - Facily Pay\",\"frontPosition\":5,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"oney.png\",\"additionalFields\":[]},\"aura\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Aura\",\"displayName\":\"Aura\",\"frontPosition\":6,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"aura.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"banamex\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Banamex\",\"displayName\":\"Banamex\",\"frontPosition\":7,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"MXN\"],\"countries\":[\"MX\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"banamex.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CURP\/CPN\",\"fr\":\"CURP\/CPN\"},\"type\":\"text\",\"required\":true,\"controlType\":\"curp-cpn\"}}}},\"banco-do-brasil\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Banco do brazil\",\"displayName\":\"Banco do brazil\",\"frontPosition\":8,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"banco-do-brasil.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"bbva-bancomer\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"BBVA Bancomer\",\"displayName\":\"BBVA Bancomer\",\"frontPosition\":9,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"MXN\"],\"countries\":[\"MX\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"bbva.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CURP\/CPN\",\"fr\":\"CURP\/CPN\"},\"type\":\"text\",\"required\":true,\"controlType\":\"curp-cpn\"}}}},\"dexia-directnet\":{\"displayNameBO\":\"Belfius Direct Net\",\"displayName\":\"Belfius Direct Net\",\"frontPosition\":10,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"dexia-directnet.png\",\"additionalFields\":[]},\"boleto-bancario\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Boleto bancario\",\"displayName\":\"Boleto bancario\",\"frontPosition\":11,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"boleto.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"bradesco\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Bradesco\",\"displayName\":\"Bradesco\",\"frontPosition\":12,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"bradesco.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"caixa\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Ca\u00efxa\",\"displayName\":\"Ca\u00efxa\",\"frontPosition\":13,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"aura.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"giropay\":{\"displayNameBO\":\"Giropay\",\"displayName\":\"Giropay\",\"frontPosition\":14,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"DE\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"giropay.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\IssuerBankIDPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"issuer_bank_id\":{\"label\":{\"en\":\"Business Identifier Code (BIC)\",\"fr\":\"Business Identifier Code (BIC)\"},\"type\":\"text\",\"required\":true,\"controlType\":\"bic\"}}}},\"ideal\":{\"displayNameBO\":\"IDEAL\",\"displayName\":\"IDEAL\",\"frontPosition\":15,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"NL\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"ideal.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\IssuerBankIDPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"issuer_bank_id\":{\"label\":{\"en\":\"Business Identifier Code (BIC)\",\"fr\":\"Business Identifier Code (BIC)\"},\"type\":\"text\",\"required\":true,\"controlType\":\"bic\"}}}},\"ing-homepay\":{\"displayNameBO\":\"ING Home'Pay\",\"displayName\":\"ING Home'Pay\",\"frontPosition\":16,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"ing-homepay.png\",\"additionalFields\":[]},\"itau\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Itau\",\"displayName\":\"Itau\",\"frontPosition\":17,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"itau.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"klarna\":{\"displayNameBO\":\"Klarna\",\"displayName\":\"Klarna\",\"frontPosition\":18,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"DE\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"klarna.png\",\"additionalFields\":[]},\"oxxo\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Oxxo\",\"displayName\":\"Oxxo\",\"frontPosition\":19,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"MXN\"],\"countries\":[\"MX\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"oxxo.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CURP\/CPN\",\"fr\":\"CURP\/CPN\"},\"type\":\"text\",\"required\":true,\"controlType\":\"curp-cpn\"}}}},\"paypal\":{\"displayNameBO\":\"Paypal\",\"displayName\":\"Paypal\",\"frontPosition\":20,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"paypal.png\",\"additionalFields\":[]},\"postfinance-card\":{\"group\":{\"code\":\"postfinance\",\"label\":\"PostFinance\"},\"displayNameBO\":\"PostFinance Card\",\"displayName\":\"PostFinance Card\",\"frontPosition\":21,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"postfinance-card.png\",\"additionalFields\":[]},\"postfinance-efinance\":{\"group\":{\"code\":\"postfinance\",\"label\":\"PostFinance\"},\"displayNameBO\":\"PostFinance E-Finance\",\"displayName\":\"PostFinance E-Finance\",\"frontPosition\":22,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"postfinance-efinance.png\",\"additionalFields\":[]},\"przelewy24\":{\"displayNameBO\":\"Przelewy24\",\"displayName\":\"Przelewy24\",\"frontPosition\":23,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"PLN\"],\"countries\":[\"PL\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"p24.png\",\"additionalFields\":[]},\"santander-cash\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Santander Cash\",\"displayName\":\"Santander Cash\",\"frontPosition\":24,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"MXN\"],\"countries\":[\"MX\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"satander.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CURP\/CPN\",\"fr\":\"CURP\/CPN\"},\"type\":\"text\",\"required\":true,\"controlType\":\"curp-cpn\"}}}},\"santander-home-banking\":{\"group\":{\"code\":\"astropay\",\"label\":\"Astropay\"},\"displayNameBO\":\"Santander HomeBanking\",\"displayName\":\"Santander HomeBanking\",\"frontPosition\":25,\"activated\":0,\"canRefund\":0,\"canManualCapture\":0,\"currencies\":[\"BRL\"],\"countries\":[\"BR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"satander.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\AstropayPaymentMethod\",\"defaultFieldsValue\":[],\"formFields\":{\"national_identification_number\":{\"label\":{\"en\":\"CPF\",\"fr\":\"CPF\"},\"type\":\"text\",\"required\":true,\"controlType\":\"cpf\"}}}},\"sdd\":{\"displayNameBO\":\"SEPA Direct Debit\",\"displayName\":\"SEPA Direct Debit\",\"frontPosition\":26,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"electronicSignature\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"electronicSignature\":1,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"sdd.png\",\"additionalFields\":{\"sdkClass\":\"HiPay\\\Fullservice\\\Gateway\\\Request\\\PaymentMethod\\\SEPADirectDebitPaymentMethod\",\"defaultFieldsValue\":{\"recurring_payment\":0},\"formFields\":{\"gender\":{\"label\":{\"en\":\"Gender\",\"fr\":\"Civilit\u00e9\"},\"type\":\"gender\",\"required\":true,\"controlType\":false},\"firstname\":{\"label\":{\"en\":\"Firstname\",\"fr\":\"Pr\u00e9nom\"},\"type\":\"text\",\"required\":true,\"controlType\":false},\"lastname\":{\"label\":{\"en\":\"Lastname\",\"fr\":\"Nom\"},\"type\":\"text\",\"required\":true,\"controlType\":false},\"bank_name\":{\"label\":{\"en\":\"Bank name\",\"fr\":\"Nom de la banque\"},\"type\":\"text\",\"required\":true,\"controlType\":false},\"iban\":{\"label\":{\"en\":\"IBAN\",\"fr\":\"IBAN\"},\"type\":\"text\",\"required\":true,\"controlType\":\"iban\"},\"issuer_bank_id\":{\"label\":{\"en\":\"BIC\",\"fr\":\"BIC\"},\"type\":\"text\",\"required\":true,\"controlType\":\"bic\"}}}},\"sisal\":{\"displayNameBO\":\"Sisal\",\"displayName\":\"Sisal\",\"frontPosition\":27,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"sisal.png\",\"additionalFields\":[]},\"sofort-uberweisung\":{\"displayNameBO\":\"Sofort \u00dcberweisung\",\"displayName\":\"Sofort \u00dcberweisung\",\"frontPosition\":28,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"EUR\"],\"countries\":[\"GB\",\"FR\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":0,\"currencySelectorReadOnly\":0,\"forceHpayment\":0,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"sofort.png\",\"additionalFields\":[]},\"webmoney-transfert\":{\"displayNameBO\":\"WebMoney Transfer\",\"displayName\":\"WebMoney Transfer\",\"frontPosition\":29,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"RUB\"],\"countries\":[\"RU\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":1,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"webmoney.png\",\"additionalFields\":[]},\"yandex\":{\"displayNameBO\":\"Yandex Money\",\"displayName\":\"Yandex Money\",\"frontPosition\":30,\"activated\":0,\"canRefund\":1,\"canManualCapture\":1,\"currencies\":[\"RUB\"],\"countries\":[\"RU\"],\"displayConfigurationFields\":[\"displayName\",\"minAmount\",\"maxAmount\",\"countries\"],\"countrySelectorReadOnly\":1,\"currencySelectorReadOnly\":1,\"forceHpayment\":1,\"forceBasket\":0,\"minAmount\":{\"EUR\":0},\"maxAmount\":{\"EUR\":false},\"logo\":\"yandex.png\",\"additionalFields\":[]}}},\"fraud\":{\"payment_fraud_email_sender\":\"demo@hipay.com\",\"send_payment_fraud_email_copy_to\":\"\",\"send_payment_fraud_email_copy_method\":\"bcc\"}}"

    php console.php c:flush

    # INSTALL X DEBUG
    echo '' | pecl install xdebug
    echo "zend_extension=$(find /usr/local/lib/php/extensions/ -name xdebug.so)" > /usr/local/etc/php/conf.d/xdebug.ini
    echo "xdebug.remote_enable=on" >> /usr/local/etc/php/conf.d/xdebug.ini
    echo "xdebug.remote_autostart=off" >> /usr/local/etc/php/conf.d/xdebug.ini
   
   #===================================#
    #            ADD CRON
    #===================================#
    #crontab -l | { cat; echo "*/5 * * * *  php /var/www/html/modules/hipay_enterprise/cron.php > /var/log/cron.log"; } | crontab -
    #service cron start
fi

chown -R www-data:www-data /var/www/html
chmod -R 755 /var/www/html

#===================================#
#       START WEBSERVER
#===================================#
printf "${COLOR_SUCCESS}                                                                           ${NC}\n"
printf "${COLOR_SUCCESS}    |======================================================================${NC}\n"
printf "${COLOR_SUCCESS}    |                                                                      ${NC}\n"
printf "${COLOR_SUCCESS}    |               DOCKER PRESTASHOP TO HIPAY $ENVIRONMENT IS UP          ${NC}\n"
printf "${COLOR_SUCCESS}    |                                                                      ${NC}\n"
printf "${COLOR_SUCCESS}    |   URL FRONT       : http://$PS_DOMAIN                                ${NC}\n"
printf "${COLOR_SUCCESS}    |   URL BACK        : http://$PS_DOMAIN/$PS_FOLDER_ADMIN               ${NC}\n"
printf "${COLOR_SUCCESS}    |   URL MAIL CATCHER: http://localhost:1095/                           ${NC}\n"
printf "${COLOR_SUCCESS}    |                                                                      ${NC}\n"
printf "${COLOR_SUCCESS}    |   PHP VERSION     : $PHP_VERSION                                     ${NC}\n"
printf "${COLOR_SUCCESS}    |======================================================================${NC}\n"
exec apache2-foreground